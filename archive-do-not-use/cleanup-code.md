I think all the functionality is correct. Please cleanup anything that we might have left over or propose simplifying anything that is too complcated
