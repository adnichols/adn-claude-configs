# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Repository Structure

This is a Claude Code and Codex configuration repository containing:

### Configuration Directories (Source of Truth)
- **claude/**: Claude Code configuration
  - `agents/` - Agent definitions for specialized tasks
  - `commands/` - Slash commands for task processing and code management
  - `scripts/` - Helper scripts for documentation and utilities
  - `settings.local.json` - Claude Code project settings
  - `mcp-servers.json` - MCP server definitions
- **codex/**: Codex configuration
  - `prompts/` - Codex prompts (includes all claude commands + codex-specific prompts)
  - `scripts/` - Shared utility scripts
  - `config.toml` - Codex configuration template
  - `mcp-servers.toml` - MCP server definitions

### Installation Scripts
- **install.sh**: Install and update configurations (auto-detects existing installations)

## Installation

Install configurations to any project using:

```bash
# Install Claude Code
bash /path/to/adn-claude-configs/install.sh --claude

# Install Codex
bash /path/to/adn-claude-configs/install.sh --codex

# Install both
bash /path/to/adn-claude-configs/install.sh --all
```

This copies the appropriate configuration to `.claude/` and/or `.codex/` directories.

## Updating

To sync the latest changes from this repository, simply run the install script again:

```bash
cd /path/to/your/project
bash /path/to/adn-claude-configs/install.sh --all
```

The install script auto-detects existing installations and:
- Updates agents, commands/prompts, and scripts from claude/ and codex/ directories
- Cleans up legacy directory structures (flattens nested commands, removes old file names)
- Preserves your local settings files
- Skips CLAUDE.md and CODEX.md (generated by codex)

## Custom Agents

Key specialized agents available:

- `developer`: Implements specs with tests - enforces zero linting violations
- `developer-fidelity`: Implements ONLY what's specified - no scope additions
- `quality-reviewer`: Reviews code for production failures (security, data loss, performance)
- `quality-reviewer-fidelity`: Reviews against specification requirements ONLY - prevents scope creep
- `simplify-planner`: Code cleanup specialist for complexity reduction
- `debugger`: Systematic bug analysis through evidence gathering
- `technical-writer`: Creates documentation after feature completion

## Custom Commands

Important slash commands:

### Workflow Commands
- `/prd:1:create-prd`: Create Product Requirements Documents with strict scope preservation
- `/prd:2:gen-tasks`: Convert PRDs to task lists using fidelity-preserving approach
- `/spec:1:create-spec`: Research ideas and produce specification documents
- `/spec:2:gen-tasks`: Convert specifications directly to tasks with 100% fidelity
- `/3:process-tasks`: Process task lists autonomously - executes entire phases with fidelity agents (unified for both PRD and spec workflows)

### Documentation Commands
- `/doc:fetch`: Fetch documentation for a single library/framework
- `/doc:fetch-batch`: Batch fetch documentation from markdown lists containing multiple libraries

### Code Quality Commands
- `/simplify:1:create-plan`: Generate code simplification plans using simplify-planner agent
- `/simplify:2:process-plan`: Execute existing simplification plans

### Git Utility Commands
- `/cmd:commit-push`: Commit all changes in the repo and push to GitHub
- `/cmd:create-pr`: Create a pull request
- `/cmd:start-linear-issue`: Start work on a Linear issue with branch management

### Other Utility Commands
- `/user:add-command`: Create new personal slash commands in ~/.claude/commands

## Configuration Notes

- Uses "sonnet" model as default
- MCP servers are pre-configured (Playwright included by default)
- Custom status line shows current directory and git branch with status
- Installation copies files (not symlinks) for independence
- Both Claude Code and Codex can be installed to the same project
- CLAUDE.md and CODEX.md are NOT installed - codex generates these files


## Available Documentation
- **Reactjs** (librarie): `docs/libraries/reactjs/` - 0% complete - *Updated 2025-08-31*


Fetched documentation available for enhanced Claude Code assistance:

- **Express** (framework): `docs/frameworks/express/` - 0% complete - *Updated 2025-08-31*
- **Lodash** (library): `docs/libraries/lodash/` - 0% complete - *Updated 2025-08-31*

## Important Workflow Patterns

### Task Processing Requirements

When using `/3:process-tasks`:

- Must be on a git branch other than main
- Uses fidelity-preserving agents (developer-fidelity, quality-reviewer-fidelity)
- **Processes entire phases autonomously** - no confirmation required between subtasks (use NOSUBCONF flag)
- Updates task list markdown after each subtask completion
- Test suite must pass before committing (only if tests were specified in source)
- Follow conventional commit format with descriptive messages
- Implement ONLY what's explicitly specified in source documents
- Auto-detects whether source is PRD or specification
- Stops only when: phase complete, clarification needed, or validation fails 3+ times

### Fidelity-Preserving Workflow

All commands now follow the fidelity-preserving approach:

- **Exact Implementation**: Build only features explicitly specified in source documents
- **No Scope Expansion**: Zero additions beyond explicit requirements
- **Question Ambiguities**: Ask for clarification rather than making assumptions
- **Preserve Constraints**: Maintain all limitations from source specifications
- **Fidelity Agents**: Always use developer-fidelity and quality-reviewer-fidelity for implementation

### Code Simplification Workflow

1. Use `/simplify:1:create-plan` to analyze and plan
2. Quality review with @quality-reviewer agent
3. User approval required before implementation
4. Use `/simplify:2:process-plan` for execution

### Batch Documentation Workflow

Use `/doc:fetch-batch` to process multiple libraries from README sections:

1. **Markdown Parsing**: Extracts `[Library Name](URL)` patterns from bullet points
2. **Intelligent Mapping**: Maps display names to fetchable identifiers (e.g., "Next.js 15" â†’ `nextjs --version 15`)
3. **Batch Processing**: Calls `/doc:fetch` for each library with appropriate parameters
4. **Progress Tracking**: Reports success/failure for each library in the batch
5. **CLAUDE.md Integration**: Automatically updates documentation references

Options:
- `--dry-run`: Preview what would be fetched
- `--parallel`: Process libraries concurrently (faster)
- `--skip-existing`: Skip libraries with existing documentation
- `--file README.md --section "Dependencies"`: Extract from file section

### Quality Standards

All agents reference CLAUDE.md for:

- Project-specific quality standards
- Error handling patterns
- Testing requirements
- Build and linting commands

## MCP Server Configuration

MCP servers are pre-configured in `claude/mcp-servers.json` and `codex/mcp-servers.toml`:

- **Playwright**: Browser automation and testing
- Add more servers as needed for your project

After installation, merge MCP server configurations:
- **Claude Desktop**: Add to `~/Library/Application Support/Claude/claude_desktop_config.json`
- **Codex**: Add to `~/.codex/config.toml`

## Maintenance

To keep installed configurations up-to-date:

1. **Update source**: Edit files in `claude/` or `codex/` directories in this repository
2. **Sync to projects**: Run `bash install.sh --all` in target projects
3. **Preserve settings**: Local settings files are never overwritten

The `claude/` and `codex/` directories are the source of truth. Changes here are distributed via the install script.
