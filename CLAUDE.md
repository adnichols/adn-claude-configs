# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Repository Structure

This is a Claude Code and Codex configuration repository containing:

### Source Directories (Maintained Here)
- **agents/**: Source agent definitions for specialized tasks
- **commands/**: Source slash commands for task processing and code management

### Installable Configurations
- **claude/**: Installable Claude Code configuration
  - `agents/`, `commands/`, `scripts/` - Copied from source
  - `settings.local.json` - Claude Code project settings
  - `mcp-servers.json` - MCP server definitions
- **codex/**: Installable Codex configuration
  - `prompts/` - Adapted from commands
  - `scripts/` - Shared utility scripts
  - `config.toml` - Codex configuration template
  - `mcp-servers.toml` - MCP server definitions

### Installation Scripts
- **scripts/install.sh**: Install configurations to projects
- **scripts/update.sh**: Sync updates to installed projects

## Installation

Install configurations to any project using:

```bash
# Install Claude Code
bash /path/to/adn-claude-configs/scripts/install.sh --claude

# Install Codex
bash /path/to/adn-claude-configs/scripts/install.sh --codex

# Install both
bash /path/to/adn-claude-configs/scripts/install.sh --all
```

This copies the appropriate configuration to `.claude/` and/or `.codex/` directories.

## Updating

Sync the latest changes from this repository to installed projects:

```bash
cd /path/to/your/project
bash /path/to/adn-claude-configs/scripts/update.sh
```

The update script:
- Auto-detects installed tools
- Updates agents, commands/prompts, and scripts
- Preserves your local settings files
- Skips CLAUDE.md and CODEX.md (generated by codex)

## Custom Agents

Key specialized agents available:

- `developer`: Implements specs with tests - enforces zero linting violations
- `developer-fidelity`: Implements ONLY what's specified - no scope additions
- `quality-reviewer`: Reviews code for production failures (security, data loss, performance)
- `quality-reviewer-fidelity`: Reviews against specification requirements ONLY - prevents scope creep
- `simplify-planner`: Code cleanup specialist for complexity reduction
- `debugger`: Systematic bug analysis through evidence gathering
- `technical-writer`: Creates documentation after feature completion

## Custom Commands

Important slash commands:

- `/p:create-prd`: Create Product Requirements Documents with strict scope preservation
- `/p:gen-tasks`: Convert PRDs to task lists using fidelity-preserving approach
- `/p:spec-to-tasks`: Convert specifications directly to tasks with 100% fidelity
- `/b:process-tasks`: Process task lists with fidelity agents and git branch management
- `/simplify:create-plan`: Generate code simplification plans using simplify-planner agent
- `/simplify:process-plan`: Execute existing simplification plans
- `/docs:fetch`: Fetch documentation for a single library/framework
- `/docs:fetch-batch`: Batch fetch documentation from markdown lists containing multiple libraries
- `/user:add-command`: Create new personal slash commands in ~/.claude/commands

## Configuration Notes

- Uses "sonnet" model as default
- MCP servers are pre-configured (Playwright included by default)
- Custom status line shows current directory and git branch with status
- Installation copies files (not symlinks) for independence
- Both Claude Code and Codex can be installed to the same project
- CLAUDE.md and CODEX.md are NOT installed - codex generates these files


## Available Documentation
- **Reactjs** (librarie): `docs/libraries/reactjs/` - 0% complete - *Updated 2025-08-31*


Fetched documentation available for enhanced Claude Code assistance:

- **Express** (framework): `docs/frameworks/express/` - 0% complete - *Updated 2025-08-31*
- **Lodash** (library): `docs/libraries/lodash/` - 0% complete - *Updated 2025-08-31*

## Important Workflow Patterns

### Task Processing Requirements

When using `/b:process-tasks`:

- Must be on a git branch other than main
- Uses fidelity-preserving agents (developer-fidelity, quality-reviewer-fidelity)
- One sub-task at a time (requires user confirmation unless NOSUBCONF specified)
- Test suite must pass before committing (only if tests were specified in source)
- Follow conventional commit format with descriptive messages
- Implement ONLY what's explicitly specified in source documents

### Fidelity-Preserving Workflow

All commands now follow the fidelity-preserving approach:

- **Exact Implementation**: Build only features explicitly specified in source documents
- **No Scope Expansion**: Zero additions beyond explicit requirements
- **Question Ambiguities**: Ask for clarification rather than making assumptions
- **Preserve Constraints**: Maintain all limitations from source specifications
- **Fidelity Agents**: Always use developer-fidelity and quality-reviewer-fidelity for implementation

### Code Simplification Workflow

1. Use `/simplify:create-plan` to analyze and plan
2. Quality review with @quality-reviewer agent
3. User approval required before implementation
4. Use `/simplify:process-plan` for execution

### Batch Documentation Workflow

Use `/docs:fetch-batch` to process multiple libraries from README sections:

1. **Markdown Parsing**: Extracts `[Library Name](URL)` patterns from bullet points
2. **Intelligent Mapping**: Maps display names to fetchable identifiers (e.g., "Next.js 15" â†’ `nextjs --version 15`)
3. **Batch Processing**: Calls `/docs:fetch` for each library with appropriate parameters
4. **Progress Tracking**: Reports success/failure for each library in the batch
5. **CLAUDE.md Integration**: Automatically updates documentation references

Options:
- `--dry-run`: Preview what would be fetched
- `--parallel`: Process libraries concurrently (faster)
- `--skip-existing`: Skip libraries with existing documentation
- `--file README.md --section "Dependencies"`: Extract from file section

### Quality Standards

All agents reference CLAUDE.md for:

- Project-specific quality standards
- Error handling patterns
- Testing requirements
- Build and linting commands

## MCP Server Configuration

MCP servers are pre-configured in `claude/mcp-servers.json` and `codex/mcp-servers.toml`:

- **Playwright**: Browser automation and testing
- Add more servers as needed for your project

After installation, merge MCP server configurations:
- **Claude Desktop**: Add to `~/Library/Application Support/Claude/claude_desktop_config.json`
- **Codex**: Add to `~/.codex/config.toml`

## Maintenance

To keep installed configurations up-to-date:

1. **Update source** (agents/, commands/): Edit files in this repository
2. **Sync to projects**: Run `bash scripts/update.sh` in target projects
3. **Preserve settings**: Local settings files are never overwritten

The `agents/` and `commands/` directories are the source of truth. Changes here are distributed via the update script.
